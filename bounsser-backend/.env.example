# ==============================================
# BOUNCER BACKEND - ENVIRONMENT CONFIGURATION
# ==============================================

# Copy this file to .env and fill in your actual values
# Never commit .env files to version control

# ==============================================
# APPLICATION SETTINGS
# ==============================================
NODE_ENV=development
PORT=3000
API_VERSION=v1
APP_NAME=Bouncer
APP_URL=http://localhost:3000

# ==============================================
# DATABASE CONFIGURATION
# ==============================================
# PostgreSQL Database URL
# Format: postgresql://username:password@host:port/database
DATABASE_URL=postgresql://xidentia:password@localhost:5432/bouncer_dev
DATABASE_URL_TEST=postgresql://xidentia:password@localhost:5432/bouncer_test

# Database Pool Settings
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_TIMEOUT=30000

# ==============================================
# REDIS CONFIGURATION
# ==============================================
# Redis connection for caching and queues
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis for sessions (can be same as above)
REDIS_SESSION_URL=redis://localhost:6379/1

# ==============================================
# TWITTER/X API CONFIGURATION
# ==============================================
# Twitter API v2 Credentials
TWITTER_API_KEY=your_twitter_api_key_here
TWITTER_API_SECRET=your_twitter_api_secret_here
TWITTER_ACCESS_TOKEN=your_twitter_access_token_here
TWITTER_ACCESS_TOKEN_SECRET=your_twitter_access_token_secret_here

# Twitter App Credentials for OAuth
TWITTER_CLIENT_ID=your_twitter_client_id_here
TWITTER_CLIENT_SECRET=your_twitter_client_secret_here

# Twitter API URLs
TWITTER_API_BASE_URL=https://api.twitter.com/2
TWITTER_OAUTH_CALLBACK_URL=http://localhost:3000/auth/twitter/callback

# Rate Limiting
TWITTER_RATE_LIMIT_WINDOW=900000
TWITTER_RATE_LIMIT_MAX_REQUESTS=300

# ==============================================
# AUTHENTICATION & SECURITY
# ==============================================
# JWT Configuration
JWT_SECRET=your_super_secret_jwt_key_change_this_in_production
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=your_refresh_token_secret_change_this
JWT_REFRESH_EXPIRES_IN=30d

# Session Configuration
SESSION_SECRET=your_session_secret_change_this_in_production
SESSION_MAX_AGE=86400000

# Encryption for sensitive data
ENCRYPTION_KEY=your_32_character_encryption_key_here
ENCRYPTION_IV_LENGTH=16

# Password Hashing
BCRYPT_ROUNDS=12

# ==============================================
# BULLMQ QUEUE CONFIGURATION
# ==============================================
# Queue Settings
QUEUE_CONCURRENCY_STREAM=5
QUEUE_CONCURRENCY_WEBHOOK=10
QUEUE_CONCURRENCY_SCORING=3
QUEUE_CONCURRENCY_NOTIFICATION=8

# Queue Retry Settings
QUEUE_MAX_RETRIES=3
QUEUE_RETRY_DELAY=5000

# ==============================================
# NOTIFICATION SERVICES
# ==============================================
# Email Configuration (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password
EMAIL_FROM=noreply@bouncer.com

# Slack Integration
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
SLACK_SIGNING_SECRET=your_slack_signing_secret
SLACK_DEFAULT_CHANNEL=#security-alerts

# Discord Integration
DISCORD_BOT_TOKEN=your_discord_bot_token
DISCORD_GUILD_ID=your_discord_guild_id
DISCORD_CHANNEL_ID=your_discord_channel_id

# ==============================================
# MONITORING & OBSERVABILITY
# ==============================================
# Logging Configuration
LOG_LEVEL=info
LOG_FILE_PATH=logs/app.log
LOG_MAX_SIZE=20m
LOG_MAX_FILES=5
LOG_DATE_PATTERN=YYYY-MM-DD

# Metrics & Prometheus
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health Check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health

# ==============================================
# FEATURE FLAGS & SCORING
# ==============================================
# Impersonation Detection Settings
SCORING_WEIGHTS_USERNAME=0.4
SCORING_WEIGHTS_DISPLAY_NAME=0.3
SCORING_WEIGHTS_PROFILE_IMAGE=0.2
SCORING_WEIGHTS_METADATA=0.1

# Thresholds
THRESHOLD_LOW=0.3
THRESHOLD_MEDIUM=0.6
THRESHOLD_HIGH=0.8

# Feature Flags
FEATURE_AUTO_REPLY=false
FEATURE_ML_SCORING=false
FEATURE_IMAGE_ANALYSIS=true
FEATURE_ADVANCED_METRICS=true

# ==============================================
# EXTERNAL SERVICES
# ==============================================
# Image Analysis (if using external service)
VISION_API_KEY=your_vision_api_key
VISION_API_URL=https://api.example-vision-service.com

# Machine Learning Service
ML_SERVICE_URL=http://localhost:8080
ML_SERVICE_API_KEY=your_ml_service_api_key

# Webhook URLs for notifications
WEBHOOK_SLACK=https://hooks.slack.com/services/your/webhook/url
WEBHOOK_DISCORD=https://discord.com/api/webhooks/your/webhook/url

# ==============================================
# RATE LIMITING
# ==============================================
# API Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# Per-endpoint limits
RATE_LIMIT_AUTH_MAX=5
RATE_LIMIT_API_MAX=100
RATE_LIMIT_WEBHOOK_MAX=1000

# ==============================================
# CORS & SECURITY
# ==============================================
# CORS Configuration
CORS_ORIGIN=http://localhost:3000,http://localhost:3001
CORS_CREDENTIALS=true

# Security Headers
SECURITY_HSTS_MAX_AGE=31536000
SECURITY_CONTENT_SECURITY_POLICY=default-src 'self'

# ==============================================
# DEVELOPMENT & TESTING
# ==============================================
# Development Settings
DEV_ENABLE_SWAGGER=true
DEV_ENABLE_PLAYGROUND=true
DEV_MOCK_TWITTER_API=false

# Testing
TEST_TIMEOUT=30000
TEST_DB_RESET=true
TEST_PARALLEL=false

# ==============================================
# DEPLOYMENT & INFRASTRUCTURE
# ==============================================
# Docker Settings
DOCKER_REGISTRY=ghcr.io/bouncer
DOCKER_IMAGE_TAG=latest

# Kubernetes
K8S_NAMESPACE=bouncer
K8S_SERVICE_ACCOUNT=bouncer-sa

# Health Checks
READINESS_PROBE_PATH=/ready
LIVENESS_PROBE_PATH=/live

# ==============================================
# BACKUP & MAINTENANCE
# ==============================================
# Database Backup
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=bouncer-backups
BACKUP_S3_REGION=us-east-1

# Maintenance Mode
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=System under maintenance. Please try again later.

# ==============================================
# DEBUGGING & PROFILING
# ==============================================
# Debug Settings
DEBUG=bouncer:*
DEBUG_COLORS=true
DEBUG_HIDE_DATE=false

# Performance Monitoring
ENABLE_PROFILING=false
PROFILING_SAMPLE_RATE=0.1

# Memory Monitoring
MEMORY_LIMIT_MB=512
MEMORY_WARNING_THRESHOLD=0.8
